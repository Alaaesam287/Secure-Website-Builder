# Threats Table — Secure E-Commerce Website Builder

| Component               | Vulnerability                                              | What It Could Lead To                                                                  | Risk Level   | Mitigation                                                                   |
|:------------------------|:-----------------------------------------------------------|:---------------------------------------------------------------------------------------|:-------------|:-----------------------------------------------------------------------------|
| Login Form              | Brute-force login attempts                                 | Account takeover, unauthorized admin access                                            | High         | CAPTCHA, rate limiting, account lockout, 2FA                                 |
|                        | SQL Injection in username/password fields                  | Unauthorized DB access, data leakage, full system compromise                           | High         | Use parameterized queries, ORM, input validation                             |
| Input Fields (General)  | Cross-site scripting (XSS) via user input                  | Session theft, website defacement, phishing redirects                                  | High         | Input sanitization, output encoding, CSP headers                             |
|                         | HTML injection                                             | UI defacement, malicious links                                                         | Medium       | Strip or escape HTML, restrict allowed tags                                  |
|                         | Business logic bypass (e.g., price manipulation)           | Financial loss, discount abuse                                                         | High         | Recalculate prices on backend, validate input values                         |
| Search Bar / Filters    | Reflected XSS via search parameters                        | Script injection, phishing                                                             | High         | Sanitize inputs, encode output, limit query lengths                          |
|                         | SQL Injection on search/filter                             | Unauthorized database access                                                           | High         | Use ORM, parameterized queries                                               |
| File Upload             | Malicious file upload (e.g., `.php` shells, malware)       | Remote code execution, server takeover                                                 | High         | MIME type checking, antivirus scanning, rename files, store outside webroot  |
| Payment & Order Process | Race condition in coupon use or order submission           | Double-use of coupon codes, multiple unauthorized purchases, fraud, stock manipulation | High         | Atomic transactions, DB locks, idempotent APIs, rate limiting                |
| Account System          | Account enumeration via login/forgot-password/registration | Identifying valid user accounts → targeted brute-force or phishing attacks             | Medium       | Generic error messages, CAPTCHA, rate limiting, abnormal behavior monitoring |
